{% include 'header.html' %}
<br>
<br>
<br>

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Your Cart</title>
    <style>
        table {
            width: 100%;
            border-collapse: collapse;
        }
        th, td {
            border: 1px solid #dddddd;
            padding: 8px;
            text-align: left;
        }
        th {
            background-color: #f2f2f2;
        }
        .item-total {
            text-align: right;
        }
        .item-image {
            width: 50px;
            height: 50px;
            object-fit: cover;
        }
    </style>
</head>
<body>
    <table>
        <thead>
            <tr>
                <th>Image</th>
                <th>Item</th>
                <th>Price</th>
                <th>Quantity</th>
                <th>Total</th>
            </tr>
        </thead>
        <tbody>
            {% for item in cart.cartitem_set.all %}
            <tr>
                <td><img src="{{ item.product.img.url }}" alt="{{ item.product.name }}" class="item-image"></td>
                <td>{{ item.product.name }}</td>
                <td>{{ item.product.price }}</td>
                <td>{{ item.quantity }}</td>
                <td class="item-total"></td>
            </tr>
            {% endfor %}
        </tbody>
    </table>

    <!-- <p>Total Price: <span id="total-price"></span></p> -->
    
    <div class="bor10 p-lr-40 p-t-30 p-b-40 m-l-63 m-r-40 m-lr-0-xl p-lr-15-sm">
        <h4 class="mtext-109 cl2 p-b-30">
            Cart Totals
        </h4>
        <div class="flex-w flex-t bor12 p-b-13">
            <div class="size-208">
                <span class="stext-110 cl2">
                    Subtotal: {{ cart.sub_total }}

                    
                </span>
            </div>
            <div class="size-209">
                <span class="mtext-110 cl2">
                    <!-- <p>Total Price: <span id="total-price"></span></p> -->
                </span>
            </div>
        </div>
        <div class="flex-w flex-t bor12 p-t-15 p-b-30">
            <div class="size-208 w-full-ssm">
                <span class="stext-110 cl2">
                    Shipping:
                </span>
            </div>
            <div class="size-209 p-r-18 p-r-0-sm w-full-ssm">
                <p class="stext-111 cl6 p-t-2">
                    There are no shipping methods available. Please double check your address, or contact us if you need any assistance.
                </p>
                <div class="p-t-15">
                    <span class="stext-112 cl8">
                        Calculate Shipping
                    </span>
                    <div class="rs1-select2 rs2-select2 bor8 bg0 m-b-12 m-t-9">
                        <select class="js-select2" name="time">
                            <option>Select a country...</option>
                            <option>USA</option>
                            <option>UK</option>
                        </select>
                        <div class="dropDownSelect2"></div>
                    </div>
                    <div class="bor8 bg0 m-b-12">
                        <input class="stext-111 cl8 plh3 size-111 p-lr-15" type="text" name="state" placeholder="State / country">
                    </div>
                    <div class="bor8 bg0 m-b-22">
                        <input class="stext-111 cl8 plh3 size-111 p-lr-15" type="text" name="postcode" placeholder="Postcode">
                    </div>
                    <div class="flex-w">
                        <div class="flex-c-m stext-101 cl2 size-115 bg8 bor13 hov-btn3 p-lr-15 trans-04 pointer">
                            Update Totals
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="flex-w flex-t p-t-27 p-b-33">
            <div class="size-208">
                <span class="mtext-101 cl2">
                    Total:
                </span>
            </div>
            <div class="size-209 p-t-1">
                <span class="mtext-110 cl2">
                    <p>Total Price: <span id="total-price"></span></p>
                </span>
            </div>
        </div>
        <a href="{% url 'checkout' %}" class="flex-c-m stext-101 cl0 size-116 bg3 bor14 hov-btn3 p-lr-15 trans-04 pointer">
            Proceed to Checkout
        </a>
    </div>
    <script>
        // Your JavaScript code here
        // Fetch all rows in the table
        const rows = document.querySelectorAll('tbody tr');

        let totalPrice = 0;

        rows.forEach(row => {
            // Calculate total for each item and update the corresponding cell
            const price = parseFloat(row.querySelector('td:nth-child(3)').innerText.replace('$', ''));
            const quantity = parseInt(row.querySelector('td:nth-child(4)').innerText);
            const total = price * quantity;
            row.querySelector('.item-total').innerText = '$' + total.toFixed(2);

            // Add to the total price
            totalPrice += total;
        });

        // Update the total price in the span element
        const totalPriceSpan = document.getElementById('total-price');
        totalPriceSpan.innerText = '$' + totalPrice.toFixed(2);

        // Store the total price in a variable
        const totalAmount = totalPrice;

        // Now you can access the total amount dynamically
        console.log(totalAmount); // Output: the total amount

        // You can also use it to update other elements on the page
        const anotherElement = document.getElementById('another-element');
        anotherElement.innerText = 'Total Amount: $' + totalAmount.toFixed(2);
    </script>
</body>
</html>

{% include 'footer.html' %}
